# make_token.py
"""
openssl genrsa -out docker/trusted_keys/trusted_key.pem 4096
openssl rsa -pubout -in docker/trusted_keys/trusted_key.pem -out docker/trusted_keys/trusted_key.pub
"""
import jwt  # requires PyJWT[crypto]

ISSUER = 'your company'
USER = 'your name'

with open('docker/trusted_keys/trusted_key.pem', 'r') as f: pem = f.read()
with open('docker/trusted_keys/trusted_key.pub', 'r') as f: pub= f.read()

# create a signed token
# https://opentestfactory.org/installation.html?utm_source=chatgpt.com#creating-jwt-tokens
# 出力したtokenをdocker/.envにいれて
token = jwt.encode({'iss': ISSUER, 'sub': USER}, pem, algorithm='RS512')
print(token)
print("----------------------------")
# verify it
payload = jwt.decode(token, pub, algorithms=['RS512'])
print(payload)
